From b460462cfa9c5aafe6a2f3c3121870fe9495c6b7 Mon Sep 17 00:00:00 2001
From: George Zacharia <george.zcharia@gmail.com>
Date: Tue, 24 Mar 2020 07:52:14 +0530
Subject: [PATCH] Have some fun with an ExtendedFloatingActionButton

---
 .../java/com/battlelancer/seriesguide/ui/ShowsActivity.kt | 6 +++---
 .../seriesguide/ui/shows/FabRecyclerViewScrollDetector.kt | 8 ++++----
 .../battlelancer/seriesguide/ui/shows/ShowsFragment.kt    | 4 ++--
 app/src/main/res/layout/activity_shows.xml                | 7 +++++--
 app/src/main/res/values/strings.xml                       | 3 ++-
 5 files changed, 16 insertions(+), 12 deletions(-)

diff --git a/app/src/main/java/com/battlelancer/seriesguide/ui/ShowsActivity.kt b/app/src/main/java/com/battlelancer/seriesguide/ui/ShowsActivity.kt
index 6da318757..c40423a4f 100644
--- a/app/src/main/java/com/battlelancer/seriesguide/ui/ShowsActivity.kt
+++ b/app/src/main/java/com/battlelancer/seriesguide/ui/ShowsActivity.kt
@@ -31,7 +31,7 @@ import com.battlelancer.seriesguide.ui.shows.ShowsNowFragment
 import com.battlelancer.seriesguide.util.AppUpgrade
 import com.battlelancer.seriesguide.util.TaskManager
 import com.battlelancer.seriesguide.util.Utils
-import com.google.android.material.floatingactionbutton.FloatingActionButton
+import com.google.android.material.floatingactionbutton.ExtendedFloatingActionButton
 import com.google.android.material.snackbar.Snackbar
 import com.uwetrottmann.seriesguide.billing.BillingViewModel
 import com.uwetrottmann.seriesguide.billing.BillingViewModelFactory
@@ -179,7 +179,7 @@ class ShowsActivity : BaseTopActivity(), OnAddShowListener {
 
     private fun setupViews() {
         // setup floating action button for adding shows
-        val buttonAddShow = findViewById<FloatingActionButton>(R.id.buttonShowsAdd)
+        val buttonAddShow = findViewById<ExtendedFloatingActionButton>(R.id.buttonShowsAdd)
         buttonAddShow.setOnClickListener {
             startActivity(
                 Intent(this@ShowsActivity, SearchActivity::class.java)
@@ -357,7 +357,7 @@ class ShowsActivity : BaseTopActivity(), OnAddShowListener {
      * Page change listener which hides the floating action button for all but the shows tab.
      */
     class ShowsPageChangeListener(
-        private val floatingActionButton: FloatingActionButton
+        private val floatingActionButton: ExtendedFloatingActionButton
     ) : ViewPager2.OnPageChangeCallback() {
         override fun onPageScrollStateChanged(arg0: Int) {}
         override fun onPageScrolled(arg0: Int, arg1: Float, arg2: Int) {}
diff --git a/app/src/main/java/com/battlelancer/seriesguide/ui/shows/FabRecyclerViewScrollDetector.kt b/app/src/main/java/com/battlelancer/seriesguide/ui/shows/FabRecyclerViewScrollDetector.kt
index 3d3120cae..0fc0ca98a 100644
--- a/app/src/main/java/com/battlelancer/seriesguide/ui/shows/FabRecyclerViewScrollDetector.kt
+++ b/app/src/main/java/com/battlelancer/seriesguide/ui/shows/FabRecyclerViewScrollDetector.kt
@@ -2,7 +2,7 @@ package com.battlelancer.seriesguide.ui.shows
 
 import androidx.recyclerview.widget.RecyclerView
 import com.battlelancer.seriesguide.R
-import com.google.android.material.floatingactionbutton.FloatingActionButton
+import com.google.android.material.floatingactionbutton.ExtendedFloatingActionButton
 import kotlin.math.abs
 
 /**
@@ -11,7 +11,7 @@ import kotlin.math.abs
  *
  * Built upon https://github.com/makovkastar/FloatingActionButton scroll detectors.
  */
-internal class FabRecyclerViewScrollDetector(private val button: FloatingActionButton) :
+internal class FabRecyclerViewScrollDetector(private val button: ExtendedFloatingActionButton) :
     RecyclerView.OnScrollListener() {
 
     private val scrollThreshold: Int =
@@ -35,11 +35,11 @@ internal class FabRecyclerViewScrollDetector(private val button: FloatingActionB
     }
 
     private fun onScrollDown() {
-        button.hide()
+        button.shrink()
     }
 
     private fun onScrollUp() {
-        button.show()
+        button.extend()
     }
 
 }
diff --git a/app/src/main/java/com/battlelancer/seriesguide/ui/shows/ShowsFragment.kt b/app/src/main/java/com/battlelancer/seriesguide/ui/shows/ShowsFragment.kt
index a52885570..67a6c5d33 100644
--- a/app/src/main/java/com/battlelancer/seriesguide/ui/shows/ShowsFragment.kt
+++ b/app/src/main/java/com/battlelancer/seriesguide/ui/shows/ShowsFragment.kt
@@ -43,7 +43,7 @@ import com.battlelancer.seriesguide.ui.shows.ShowsDistillationSettings.saveFilte
 import com.battlelancer.seriesguide.ui.shows.SortShowsView.ShowSortOrder
 import com.battlelancer.seriesguide.util.ViewTools
 import com.battlelancer.seriesguide.widgets.SgFastScroller
-import com.google.android.material.floatingactionbutton.FloatingActionButton
+import com.google.android.material.floatingactionbutton.ExtendedFloatingActionButton
 import org.greenrobot.eventbus.EventBus
 import org.greenrobot.eventbus.Subscribe
 import org.greenrobot.eventbus.ThreadMode
@@ -159,7 +159,7 @@ class ShowsFragment : Fragment() {
             }
 
         // hide floating action button when scrolling shows
-        val buttonAddShow: FloatingActionButton =
+        val buttonAddShow: ExtendedFloatingActionButton =
             requireActivity().findViewById(R.id.buttonShowsAdd)
         recyclerView.addOnScrollListener(FabRecyclerViewScrollDetector(buttonAddShow))
 
diff --git a/app/src/main/res/layout/activity_shows.xml b/app/src/main/res/layout/activity_shows.xml
index 36eefd2c7..7d86ae405 100644
--- a/app/src/main/res/layout/activity_shows.xml
+++ b/app/src/main/res/layout/activity_shows.xml
@@ -30,8 +30,9 @@
             android:layout_height="match_parent"
             app:layout_behavior="@string/appbar_scrolling_view_behavior" />
 
-        <com.google.android.material.floatingactionbutton.FloatingActionButton
+        <com.google.android.material.floatingactionbutton.ExtendedFloatingActionButton
             android:id="@+id/buttonShowsAdd"
+            style="@style/Widget.MaterialComponents.FloatingActionButton"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_gravity="bottom|end"
@@ -40,7 +41,9 @@
             android:layout_marginEnd="@dimen/fab_margin"
             android:layout_marginBottom="@dimen/fab_margin"
             android:contentDescription="@string/action_shows_add"
-            app:srcCompat="@drawable/ic_add_white_24dp" />
+            android:text="@string/add_show"
+            app:backgroundTint="@color/sg_color_primary"
+            app:icon="@drawable/ic_add_white_24dp" />
 
     </androidx.coordinatorlayout.widget.CoordinatorLayout>
 
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index 00e92652c..cd34c7e27 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -1,4 +1,4 @@
-ï»¿<?xml version="1.0" encoding="utf-8"?>
+<?xml version="1.0" encoding="utf-8"?>
 <resources>
 
     <!-- Main Menu -->
@@ -591,6 +591,7 @@
     <string name="feedback_question_feedback">Tell me how to improve it?</string>
     <string name="feedback_action_ok">OK, sure</string>
     <string name="feedback_action_nothanks">No, thanks</string>
+    <string name="add_show">Add show</string>
 
     <!-- Support -->
     <string name="support_the_dev">Support the developer?</string>
